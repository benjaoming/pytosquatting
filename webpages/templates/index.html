{% extends "base.html" %}
{% load cache %}
{% block content %}
  {% cache 600 everything %}
  <div class="container">
    <div class="row">
      <div class="one-half column" style="margin-top: 10%">
        <h1>Pytosquatting</h1>
        <p><strong>Work in progress:</strong> Fixing typosquatting threats in Python Package Index (PyPI).</p>
        <h2>Why?</h2>
        <p>In June 2016, <a href="http://incolumitas.com/2016/06/08/typosquatting-package-managers/">Typosquatting programming language package managers</a> stated that <code>urllib2</code> had ~4,000 downloads in 2 weeks. But in June 2017, we found the same package name vacant and so we (being the good guys) squatted it for several months up until this disclosure. We take these findings seriously.</p>
        <p>On September 13 2017, we squatted all available names of stdlib packages (128) - scroll down to see statistics from pingbacks.</p>
        <p>On September 14 2017, a number of in-the-wild malicious packages on PyPI were disclosed by <a href="http://www.nbu.gov.sk/skcsirt-sa-20170909-pypi/">Slovak National Security Authority</a>.</p>
        <h2>How?</h2>
        <ul>
          <li><strong>Strategy #1:</strong> We are typosquatting a bunch of stuff on PyPI (all available Python 2 and Python 3 standard libraries). So no matter if you use the security hardened Pip installer, we have managed to mitigate the bulk of the immediate problem.</li>
          <li><strong>Strategy #2:</strong> Use a Pip installer that does safety lookups and fails loudly if the attempted package name does not validate. This should be implemented in your automated deployments and test builds!</li>
        </ul>

        <h2>Aftermath</h2>
        <p>Being total jerks, we have a pingback in the <code>setup.py</code> of all packages involved in Strategy #1, meaning that in some time, we will know the extend of the issue. The callback doesn't involve any stats from your system, just an IP so we can count that a unique system has attempted to install a non-existing package that <em>could</em> have been exploited.</p>
        
        <p>Furthermore, we are calling for analysis of the current PyPI resources to find in-the-wild exploits of typosquatting as <a href="http://www.nbu.gov.sk/skcsirt-sa-20170909-pypi/">Slovak National Security Authority</a> has done. We hope there are none, but the problem has been around for a long time, and our primer didn't get reactions from the PyPI admins.</p>

        <h2>Mockup of Strategy #2</h2>
        <p>Once done, we hope to achieve a better pip installer that:</p>
        <ul>
          <li>Verifies that you don't install a package with the name of a stdlib</li>
          <li>Asks a webservice if you are installing a typo of a popular package</li>
        </ul>
        <p>
          <pre>
pip install pipsec
pip install virtualenv-wrapper  # See that it fails
pip install virtualenvwrapper  # This is correct
          </pre>
        </p>

        <h2>Ack</h2>
        <p>
        Send comments or complaints to
        <a href="https://overtag.dk/">Benjamin Bach</a> and
        <a href="https://hboeck.de/">Hanno BÃ¶ck</a>.
        </p>
        <p>
          Check out the code for this website on
          <a href="https://github.com/benjaoming/pytosquatting">https://github.com/benjaoming/pytosquatting</a>.
        </p>
        {% comment %}
        <p>
          The work in this project is meant to be taken as typical <strong>Careware</strong>.
          We encourage you to take a moment to care about some stuff we like to consider.
          Like global inequality and the digital divide. If you like our work,
          please sponsor: EFF, Python Foundation, Learning Equality, Libraries
          Without Borders, FAIR Denmark
        </p>
        {% endcomment %}

        <h2>Stdlib installations</h2>
        
        <p>
          Blocked stdlib installations since 20170913-20170916: <strong>{{ total_unique_ips }}</strong>
        </p>
        
        <p>
          On 20170916, PyPI removed our Top 20 of squatted packages, so our statistics won't match up anymore. They didn't remove the other 108 squatted packages.
        </p>
        
        <table>
        <thead>
        <tr>
          <th></th>
          <th>Package</th>
          <th style="text-align: right">Average per day</th>
          {% comment %}<th>Total unique hits</th>{% endcomment %}
        </tr>
        </thead>
        <tbody>
        {% for pkg in top %}
        <tr>
          <td style="text-align: right">{{ forloop.counter }}</td>
          <td>{{ pkg.package_name }}</td>
          <td style="text-align: right">{{ pkg.avg_per_day|floatformat:1 }}</td>
          {% comment %}<td>{{ pkg.unique_count }}</td>{% endcomment %}
        </tr>
        {% endfor %}
        </tbody>
        </table>


      </div>
    </div>
  </div>
{% endcache %}
{% endblock %}
